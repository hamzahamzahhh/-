<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงููุฌุงุญ ูุณุงุฑ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="form.html">ุงูุฑุฆูุณูุฉ</a>
            <a href="support.html">ุงูุฏุนู</a>
        </div>
    </header>

    <section class="form-section">
        <h1 id="pika">ุงุณุชูุงุฑุฉ ุงูุชุณุฌูู</h1>
        <form id="registrationForm">
            <label for="name">ุงูุงุณู ุงููุงูู</label>
            <input type="text" placeholder="ุงูุงุณู ุงููุงูู" id="name" required>

            <label for="phone">ุฑูู ุงููุงุชู</label>
            <input type="tel" placeholder="ุฑูู ุงููุงุชู" id="phone" required>

            <label for="level">ุงููุณุชูู ุงูุฏุฑุงุณู</label>
            <select id="level" required>
                <option value="1bac">ุฃููู ุจุงู</option>
                <option value="2bac">ุซุงููุฉ ุจุงู</option>
            </select>

            <label for="subject">ุงููุงุฏุฉ</label>
            <select id="subject" required>
                <option value="math">ุฑูุงุถูุงุช</option>
                <option value="physics">ููุฒูุงุก</option>
                <option value="ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก">ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก</option>
            </select>

            <label for="paymentProof">ุฅุซุจุงุช ุงูุฏูุน</label>
            <input type="file" id="paymentProof" required>

            <div id="totalAmount"></div>
            <button type="submit">ุฅุฑุณุงู</button>
        </form>
    </section>

    <script>
        // ุฏุงูุฉ ูุญุณุงุจ ุงููุจูุบ ุจูุงุกู ุนูู ุงูุงุฎุชูุงุฑุงุช
        function calculateTotal() {
            const level = document.getElementById('level').value;
            const subject = document.getElementById('subject').value;

            let totalAmount = 0;

            // ุชุญุฏูุฏ ุงููุจุงูุบ ุจูุงุกู ุนูู ุงูุงุฎุชูุงุฑุงุช
            if (level === '1bac' && (subject === 'math' || subject === 'physics')) {
                totalAmount = 150; // ูููุฉ ุฃููู ุจุงู ุฑูุงุถูุงุช ุฃู ููุฒูุงุก
            } else if (level === '2bac' && (subject === 'math' || subject === 'physics')) {
                totalAmount = 200; // ูููุฉ ุซุงููุฉ ุจุงู ุฑูุงุถูุงุช ุฃู ููุฒูุงุก
            } else if (level === '1bac' && subject === 'ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก') {
                totalAmount = 200; // ูููุฉ ุฃููู ุจุงู ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก
            } else if (level === '2bac' && subject === 'ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก') {
                totalAmount = 300; // ูููุฉ ุซุงููุฉ ุจุงู ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก
            }

            // ุชุญุฏูุซ ุงููุจูุบ ุงูุฅุฌูุงูู ูู ุงูุตูุญุฉ
            document.getElementById('totalAmount').textContent = `ุงููุจูุบ ุงูุฅุฌูุงูู: ${totalAmount} ุฏุฑูู`;
        }

        // ุงุณุชูุงุน ูุชุบููุฑ ุงูุงุฎุชูุงุฑุงุช
        document.getElementById('level').addEventListener('change', calculateTotal);
        document.getElementById('subject').addEventListener('change', calculateTotal);

        // ุงุณุชุฏุนุงุก ุญุณุงุจ ุงููุจูุบ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        calculateTotal();

        // ุงูุชุญูู ูู ุงููุฏุฎูุงุช ุนูุฏ ุงูุฅุฑุณุงู
        document.getElementById('registrationForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const level = document.getElementById('level').value;
            const subject = document.getElementById('subject').value;
            const paymentProof = document.getElementById('paymentProof').files[0];

            if (name && phone && level && subject && paymentProof) {
                const randomCode = Math.random().toString(36).substring(2, 12);

                // ุญูุธ ุงูููุฏ ูู sessionStorage
                sessionStorage.setItem('activationCode', randomCode);

                // ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ูุฅุฑุณุงููุง ูุน ุงูุตูุฑุฉ ุฅูู ุงูุจูุช ุงูุฃูู
                const botToken1 = '8080174902:AAHX9XK3_Yd-TkY8Vq2LBzK8BGCWFmqy17o'; 
                const chatId1 = '7203065656'; 

                const formData = new FormData();
                formData.append('chat_id', chatId1);
                formData.append('caption', `ุชู ุฅุฑุณุงู ุงูุงุณุชูุงุฑุฉ ุจูุฌุงุญ! ๐\nุงูุงุณู: ${name}\nุฑูู ุงููุงุชู: ${phone}\nุงููุณุชูู ุงูุฏุฑุงุณู: ${level}\nุงููุงุฏุฉ: ${subject}`);
                formData.append('document', paymentProof);

                try {
                    // ุฅุฑุณุงู ุงูุจูุงูุงุช ูุน ุงูุตูุฑุฉ ุฅูู ุงูุจูุช ุงูุฃูู
                    const response1 = await fetch(`https://api.telegram.org/bot${botToken1}/sendDocument`, {
                        method: 'POST',
                        body: formData,
                    });

                    const data1 = await response1.json();

                    if (data1.ok) {
                        alert('ุชู ุฅุฑุณุงู ุงูุงุณุชูุงุฑุฉ ูุฅุซุจุงุช ุงูุฏูุน ุจูุฌุงุญ! ๐');

                        // ุฅุฑุณุงู ููุฏ ุงูุชูุนูู ุฅูู ุงูุจูุช ุงูุซุงูู
                        const botToken2 = '7981448790:AAFhN4pATXu0eVRRKWwuwOMLQp01_Juo1KI'; 
                        const chatId2 = '7203065656'; 

                        const messageCode = `ูุงู ุงูููุฏ ูุณุฑุจู ุนุทู ููุงุณ ุงูููุฏ ุฏุบูุง: ${randomCode}`;

                        const response2 = await fetch(`https://api.telegram.org/bot${botToken2}/sendMessage?chat_id=${chatId2}&text=${encodeURIComponent(messageCode)}`);
                        const data2 = await response2.json();

                        if (data2.ok) {
                            // ุงูุชูุฌูู ุญุณุจ ุงูุงุฎุชูุงุฑ
                            if ((level === '1bac' || level === '2bac') && subject === 'ุงูุฑูุงุถูุงุช ูุงูููุฒูุงุก') {
                                window.location.href = 'page2.html';
                            } else if (level === '1bac' && subject === 'math') {
                                window.location.href = 'page3.html';
                            } else if (level === '1bac' && subject === 'physics') {
                                window.location.href = 'page4.html';
                            } else if (level === '2bac' && subject === 'math') {
                                window.location.href = 'page6.html';
                            } else if (level === '2bac' && subject === 'physics') {
                                window.location.href = 'page5.html';
                            }
                        } else {
                            alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ููุฏ ุงูุชูุนูู!');
                        }
                    } else {
                        alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุงูุจูุงูุงุช!');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุงูุจูุงูุงุช!');
                }
            } else {
                alert('ุงูุฑุฌุงุก ููุก ุฌููุน ุงูุญููู');
            }
        });
    </script>
</body>
</html>